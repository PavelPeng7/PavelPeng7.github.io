---
layout:     post
title:      17. 3D空间变换矩阵（3D Matrix Transformations）
subtitle:   3d Computer Graphics
date:       2024-12-27
author:     Pavel
header-img: img/Post-bg-StarKribi.jpg
catalog: true
tags:
    - 软光栅
    - 计算机图形学
---


# 1. 单位矩阵（Identity Matrix）

```c
mat4_t mat4_identity(void) {
    // | 1 0 0 0 |
    // | 0 1 0 0 |
    // | 0 0 1 0 |
    // | 0 0 0 1 |
    mat4_t m = {{
        { 1, 0, 0, 0 },
        { 0, 1, 0, 0 },
        { 0, 0, 1, 0 },
        { 0, 0, 0, 1 }
    }};
    return m;
}
```

单位矩阵特征是对角线为1，其他位置为0的矩阵。

单位矩阵相当于矩阵中的1，任何矩阵乘以单位矩阵等于这个矩阵。

# 2. 缩放矩阵(3DScale Matrix)

![iShot_2024-12-27_17.59.58.png](https://pavelblog-images-1333471781.cos.ap-shanghai.myqcloud.com/undefined20241227180231244.png?imageSlim)

```c
mat4_t mat4_make_scale(float sx, float sy, float sz){
    // | sx  0  0  0 |
    // |  0 sy  0  0 |
    // |  0  0 sz  0 |
    // |  0  0  0  1 |
    mat4_t m = mat4_identity();
    m.m[0][0] = sx;
    m.m[1][1] = sy;
    m.m[2][2] = sz;
    return m;
}
```

放缩矩阵的特点是对角线上分别放x，y，z方向上的缩放值。

> 为什么3d变换时用四维矩阵而不是三维矩阵？

为了兼容齐次坐标系（**Homogeneous Coordinates**），通过矩阵乘法统一处理缩放，旋转，平移。

并且3x3矩阵无法处理平移操作。

> 齐次坐标系中多出来的1是什么？

1. 允许表示平移变换，统一变换矩阵。
2. 投影变换，w存储深度。
3. 处理点和向量，w值为1是为点，w值为0时为向量，因为向量是方向没有起始点。

